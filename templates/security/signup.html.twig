<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription - TerraNav</title>
    
    <!-- Bootstrap et Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #FEA116; /* Orange */
            --secondary-color: #0F172B; /* Bleu foncé */
            --light-color: #FFFFFF;
            --dark-color: #0F172B;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            color: var(--dark-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            padding: 0;
            margin: 0;
        }
        
        /* Styles pour le carrousel en arrière-plan */
        .background-carousel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .carousel-item {
            height: 100vh;
        }
        
        .carousel-item img {
            object-fit: cover;
            width: 100%;
            height: 100%;
        }
        
        /* Overlay pour améliorer la lisibilité */
        .content-overlay {
            position: relative;
            z-index: 1;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            margin-top: 20px;
            margin-bottom: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        /* Mise en page horizontale à deux colonnes */
        .split-layout {
            display: flex;
            flex-direction: row;
            min-height: 550px;
            align-items: stretch;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            height: auto !important;
        }
        
        /* Colonne du logo */
        .logo-column {
            flex: 1;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px 0 0 20px;
            height: auto !important;
        }
        
        /* Colonne du formulaire */
        .form-column {
            flex: 2; /* Plus de place pour le formulaire d'inscription */
            padding: 0;
            background: white;
            border-radius: 0 20px 20px 0;
            display: flex;
            flex-direction: column;
            height: auto !important;
        }
        
        /* Logo plus grand */
        .brand-logo {
            width: 90%;
            max-width: 300px;
            margin-bottom: 20px;
            filter: drop-shadow(0 10px 15px rgba(0, 0, 0, 0.2));
            transition: all 0.5s ease;
        }
        
        .brand-logo:hover {
            transform: scale(1.03);
            filter: drop-shadow(0 15px 20px rgba(0, 0, 0, 0.3));
        }
        
        .brand-tagline {
            font-size: 1.3rem;
            color: var(--primary-color);
            font-weight: 500;
            text-align: center;
            margin-top: 20px;
            max-width: 80%;
        }
        
        .brand-description {
            text-align: center;
            margin-top: 20px;
            color: #555;
            line-height: 1.6;
            font-size: 0.95rem;
            max-width: 80%;
        }
        
        /* Carte de formulaire d'inscription */
        .signup-card {
            height: 100%;
            padding: 30px;
            display: flex;
            flex-direction: column;
        }
        
        .signup-header {
            text-align: center;
            margin-bottom: 25px;
        }
        
        .signup-header h1 {
            font-size: 1.8rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .signup-header p {
            color: #666;
            font-size: 0.95rem;
        }
        
        /* Style des sections de formulaire */
        .form-section {
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            background-color: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }
        
        .form-section:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            background-color: #f3f4f6;
        }
        
        .form-section h4 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* Styles des champs de formulaire */
        .form-control {
            border-radius: 8px;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(254, 161, 22, 0.25);
        }
        
        label {
            font-weight: 500;
            color: #444;
            margin-bottom: 8px;
        }
        
        /* Bouton d'inscription */
        .btn-signup {
            background: linear-gradient(135deg, var(--primary-color), #FF8C00);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s;
            width: 100%;
            text-align: center;
        }
        
        .btn-signup:hover {
            background: linear-gradient(135deg, #FF8C00, var(--primary-color));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(254, 161, 22, 0.4);
        }
        
        /* Lien de connexion */
        .login-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .login-link:hover {
            color: #FF8C00;
            text-decoration: underline;
        }
        
        /* Footer */
        .footer {
            background-color: var(--secondary-color);
            color: white;
            margin-top: 30px;
            border-top: 5px solid var(--primary-color);
        }
        
        /* Adaptation pour mobile */
        @media (max-width: 991px) {
            .split-layout {
                flex-direction: column;
            }
            
            .logo-column, .form-column {
                width: 100%;
                border-radius: 20px;
            }
            
            .logo-column {
                border-radius: 20px 20px 0 0;
                padding: 20px;
            }
            
            .form-column {
                border-radius: 0 0 20px 20px;
            }
            
            .brand-logo {
                width: 60%;
                margin-bottom: 10px;
            }
            
            .brand-tagline {
                font-size: 1rem;
                margin-bottom: 10px;
            }
            
            .brand-description {
                display: none;
            }
        }
        
        /* Home link */
        .home-link-container {
            text-align: center;
            margin-top: 25px;
        }

        .home-link {
            display: inline-block;
            background-color: rgba(15, 23, 43, 0.7);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            transition: all 0.3s;
        }

        .home-link:hover {
            background-color: rgba(15, 23, 43, 0.9);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Styles pour les messages d'erreur de validation */
        .invalid-feedback {
            display: block;
            width: 100%;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: #dc3545;
            font-weight: 500;
        }

        .form-error-message {
            color: #dc3545;
            font-weight: 500;
        }

        .form-error-icon {
            color: #dc3545;
        }

        /* Effet de secousse pour attirer l'attention */
        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            10%, 30%, 50%, 70%, 90% {transform: translateX(-5px);}
            20%, 40%, 60%, 80% {transform: translateX(5px);}
        }

        .is-invalid, 
        .form-control.is-invalid {
            border-color: #dc3545 !important;
            padding-right: calc(1.5em + 0.75rem);
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
            animation: shake 0.5s;
        }

        /* Style pour les messages de l'Assert spécifiquement */
        .validation-error {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: block;
        }
        
        /* Styles back to top */
        .back-to-top {
            position: fixed;
            right: 30px;
            bottom: 30px;
            z-index: 99;
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            color: white;
        }

        .back-to-top:hover {
            background-color: #E39015;
            border-color: #E39015;
            color: white;
        }
    </style>
</head>
<body>
    <!-- Carrousel d'images en arrière-plan -->
    <div id="backgroundCarousel" class="carousel slide background-carousel" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="{{ asset('img/utilisateur/travel1.gif') }}" alt="Voyage 1">
            </div>
            <div class="carousel-item">
                <img src="{{ asset('img/utilisateur/travel2.webp') }}" alt="Voyage 2">
            </div>
            <div class="carousel-item">
                <img src="{{ asset('img/utilisateur/travel3.jpg') }}" alt="Voyage 3">
            </div>
            <div class="carousel-item">
                <img src="{{ asset('img/utilisateur/travel4.jpeg') }}" alt="Voyage 4">
            </div>
            <div class="carousel-item">
                <img src="{{ asset('img/utilisateur/travel5.jpg') }}" alt="Voyage 5">
            </div>
        </div>
    </div>
    
    <main>
        <div class="container mt-5">
            <div class="content-overlay p-0">
                <div class="split-layout">
                    <!-- Colonne du logo à gauche -->
                    <div class="logo-column">
                        <img src="{{ asset('img/utilisateur/Terranav.png') }}" alt="TerraNav Logo" class="brand-logo">
                        <div class="brand-tagline">Votre passeport pour l'aventure</div>
                        <div class="brand-description">
                            Rejoignez notre communauté de voyageurs et découvrez des expériences uniques partout dans le monde. 
                            Créez votre compte en quelques étapes simples.
                        </div>
                    </div>
                    
                    <!-- Colonne du formulaire à droite -->
                    <div class="form-column">
                        <div class="signup-card">
                            <div class="signup-header">
                                <h1>Bienvenue sur TerraNav</h1>
                                <p>Créez votre compte en quelques étapes simples et commencez votre voyage avec nous.</p>
                            </div>
                            
                            {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
                                <div class="form-section">
                                    <h4><i class="fas fa-user-circle me-2"></i>Informations personnelles</h4>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            {{ form_label(form.nom, 'Nom') }}
                                            {{ form_widget(form.nom, {'attr': {'class': form_errors(form.nom) ? 'form-control is-invalid' : 'form-control', 'placeholder': 'Votre nom'}}) }}
                                            {% if form_errors(form.nom) %}
                                                <div class="invalid-feedback">
                                                    {{ form_errors(form.nom) }}
                                                </div>
                                            {% endif %}
                                        </div>
                                        
                                        <div class="col-md-6 mb-3">
                                            {{ form_label(form.prenom, 'Prénom') }}
                                            {{ form_widget(form.prenom, {'attr': {'class': form_errors(form.prenom) ? 'form-control is-invalid' : 'form-control', 'placeholder': 'Votre prénom'}}) }}
                                            {% if form_errors(form.prenom) %}
                                                <div class="invalid-feedback">
                                                    {{ form_errors(form.prenom) }}
                                                </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        {{ form_label(form.email, 'Adresse email') }}
                                        {{ form_widget(form.email, {'attr': {'class': form_errors(form.email) ? 'form-control is-invalid' : 'form-control', 'placeholder': 'exemple@email.com'}}) }}
                                        {% if form_errors(form.email) %}
                                            <div class="invalid-feedback">
                                                {{ form_errors(form.email) }}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>

                                <div class="form-section">
                                    <h4><i class="fas fa-shield-alt me-2"></i>Détails du compte</h4>
                                    <div class="mb-3">
                                        {{ form_label(form.username) }}
                                        {{ form_widget(form.username, {'attr': {'class': form_errors(form.username) ? 'form-control is-invalid' : 'form-control', 'placeholder': 'Choisissez un nom d\'utilisateur'}}) }}
                                        {% if form_errors(form.username) %}
                                            <div class="invalid-feedback">
                                                {{ form_errors(form.username) }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        {{ form_label(form.password, 'Mot de passe') }}
                                        {{ form_widget(form.password, {
                                            'attr': {
                                                'class': form_errors(form.password) ? 'form-control is-invalid' : 'form-control',
                                                'placeholder': 'Créez un mot de passe sécurisé'
                                            }
                                        }) }}
                                        {% if form_errors(form.password) %}
                                            <div class="invalid-feedback">
                                                {{ form_errors(form.password) }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        {{ form_label(form.role, 'Type de compte') }}
                                        {{ form_widget(form.role, {'attr': {'class': 'form-select', 'data-role-field': 'true'}}) }}
                                        {{ form_errors(form.role) }}
                                        <!-- Afficher l'ID réel du champ pour débogage -->
                                        <div class="small text-muted mt-1">ID du champ: {{ form.role.vars.id }}</div>
                                    </div>
                                </div>

                                <!-- Agency fields section (hidden by default) -->
                                <div id="agency-fields" class="form-section" style="display:none;">
                                    <h4><i class="fas fa-building me-2"></i>Informations sur l'agence</h4>
                                    <div class="mb-3">
                                        {{ form_label(form.nomagence, 'Nom de l\'agence') }}
                                        {{ form_widget(form.nomagence, {'attr': {'class': form_errors(form.nomagence) ? 'form-control is-invalid' : 'form-control', 'placeholder': 'Nom de votre agence'}}) }}
                                        {% if form_errors(form.nomagence) %}
                                            <div class="invalid-feedback">
                                                {{ form_errors(form.nomagence) }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="mb-3">
                                        {{ form_label(form.typeAgence, 'Type d\'agence') }}
                                        {{ form_widget(form.typeAgence, {'attr': {'class': form_errors(form.typeAgence) ? 'form-select is-invalid' : 'form-select', 'placeholder': 'Sélectionnez un type d\'agence'}}) }}
                                        {% if form_errors(form.typeAgence) %}
                                            <div class="invalid-feedback">
                                                {{ form_errors(form.typeAgence) }}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>

                                <div class="d-grid gap-2 mt-4">
                                    <button type="submit" class="btn-signup">
                                        <i class="fas fa-user-plus me-2"></i>Créer mon compte
                                    </button>
                                </div>
                            {{ form_end(form) }}

                            <div class="mt-4 text-center">
                                <p>Déjà inscrit ? <a href="{{ path('app_login') }}" class="login-link">Connectez-vous ici</a></p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="home-link-container mt-4">
                    <a href="{{ path('app_home') }}" class="home-link">
                        <i class="fas fa-arrow-left me-1"></i> Retour à l'accueil
                    </a>
                </div>
            </div>
        </div>
    </main>
    
    <div class="container-fluid bg-dark text-light footer mt-5">
        <div class="container py-4">
            <div class="row g-5">
                <div class="col-md-6">
                    <div class="d-flex align-items-center mb-3">
                        <h5 class="text-white text-uppercase me-3 mb-0">TerraNav</h5>
                        <div class="border-start border-primary ps-3">
                            <small class="text-white">Votre passeport pour l'aventure</small>
                        </div>
                    </div>
                    <p class="text-white mb-0">
                        Terranav, votre allié pour des voyages sans stress ! Que vous recherchiez un transport fiable, un hébergement confortable ou une aventure inoubliable!
                    </p>
                </div>
                <div class="col-md-6">
                    <h6 class="section-title text-start text-primary text-uppercase mb-3">Contact</h6>
                    <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>Av. Fethi Zouhir, Cebalat Ben Ammar 2083</p>
                    <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>+216 99 072 221</p>
                    <p class="mb-2"><i class="fa fa-envelope me-3"></i>terranav3a11@gmail.com</p>
                    <div class="d-flex pt-2">
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-twitter"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-youtube"></i></a>
                        <a class="btn btn-outline-light btn-social" href=""><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="container py-3 border-top border-secondary">
            <div class="row">
                <div class="col text-center">
                    <p class="mb-0 text-white-50">
                        &copy; <a class="text-primary" href="#">TerraNav</a>. Tous droits réservés. 
                        Conçu par <a class="text-primary" href="#">TerraNav Team</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square back-to-top"><i class="bi bi-arrow-up"></i></a>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Configuration du carrousel d'arrière-plan
        document.addEventListener('DOMContentLoaded', function() {
            const carousel = new bootstrap.Carousel(document.getElementById('backgroundCarousel'), {
                interval: 5000,
                pause: false,
                wrap: true,
                keyboard: false
            });
            
            // Script pour afficher/masquer les champs d'agence
            const roleSelect = document.querySelector('select[data-role-field="true"]');
            const agencyFields = document.getElementById('agency-fields');
            
            function toggleAgencyFields() {
                // Afficher la valeur sélectionnée
                console.log("Valeur sélectionnée:", roleSelect.value);
                
                // Vérifier si l'option "Agence" est sélectionnée
                if (roleSelect.value === 'Agence') {
                    console.log("Affichage des champs d'agence");
                    agencyFields.style.display = 'block';
                    // Rendre les champs d'agence requis lorsqu'ils sont visibles
                    document.querySelectorAll('#agency-fields input, #agency-fields select').forEach(function(field) {
                        field.required = true;
                    });
                } else {
                    console.log("Masquage des champs d'agence");
                    agencyFields.style.display = 'none';
                    // Supprimer l'attribut required lorsque les champs sont cachés
                    document.querySelectorAll('#agency-fields input, #agency-fields select').forEach(function(field) {
                        field.required = false;
                        field.value = ''; // Réinitialiser les valeurs
                    });
                }
            }
            
            // Vérifier que le select existe bien
            if (!roleSelect) {
                console.error("Le champ rôle n'a pas été trouvé!");
            } else {
                console.log("Champ rôle trouvé, valeur initiale:", roleSelect.value);
                
                // Vérifions les options disponibles
                Array.from(roleSelect.options).forEach(option => {
                    console.log(`Option: texte="${option.text}", valeur="${option.value}"`);
                });
                
                // État initial
                toggleAgencyFields();
                
                // Écouter les changements
                roleSelect.addEventListener('change', toggleAgencyFields);
            }
        });
    </script>
</body>
</html>